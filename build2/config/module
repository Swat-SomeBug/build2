// file      : build2/config/module -*- C++ -*-
// copyright : Copyright (c) 2014-2016 Code Synthesis Ltd
// license   : MIT; see accompanying LICENSE file

#ifndef BUILD2_CONFIG_MODULE
#define BUILD2_CONFIG_MODULE

#include <butl/prefix-map>

#include <build2/types>
#include <build2/utility>

#include <build2/module>
#include <build2/variable>

namespace build2
{
  namespace config
  {
    struct module: module_base
    {
      // A sorted list of config.* variables and their "save flags" (see
      // save_variable()) that are used (as opposed to just being specified)
      // in this configuration. Populated by the config utility functions
      // (required(), optional())
      //
      butl::prefix_map<variable_cref, uint64_t, '.'> vars;

      static const string name;
    };

    void
    boot (scope&, const location&, unique_ptr<module_base>&);

    bool
    init (scope&,
          scope&,
          const location&,
          unique_ptr<module_base>&,
          bool,
          bool,
          const variable_map&);
  }
}

#endif // BUILD2_CONFIG_MODULE
