# file      : tests/test/script/runner/redirect.test
# copyright : Copyright (c) 2014-2016 Code Synthesis Ltd
# license   : MIT; see accompanying LICENSE file

$* -o foo >-                                         # out-null
$* -e foo 2>-                                        # err-null
$* -i 0 <foo                                         # in-str
$* -o foo >foo                                       # out-str
$* -e foo 2>foo                                      # err-str
$* -i 1 <foo >foo                                    # inout-str
$* -i 2 <foo 2>foo                                   # inerr-str
$* -i 1 -e bar <foo 1>foo 2>bar                      # inout-err-str

$* -i 0 <<EOO                                        # in-doc
foo
bar
EOO

$* -o foo -o bar >>EOO                               # out-doc
foo
bar
EOO

$* -e foo -e bar 2>>EOO                              # err-doc
foo
bar
EOO

$* -i 1 <<EOI >>EOO                                  # inout-doc
foo
bar
EOI
foo
bar
EOO

$* -i 2 <<EOI 2>>EOE                                 # inerr-doc
foo
bar
EOI
foo
bar
EOE

$* -i 1 -e bar -e baz -s 2 <<EOI 1>>EOO 2>>EOE == 2  # inout-err-doc-status
foo
bar
EOI
foo
bar
EOO
bar
baz
EOE

$* -i 1 -e "" <<EOI >>EOO 2>""                       # empty-str-doc
EOI
EOO

$* -i 1 <<EOI >>EOO                                  # nl-containing-doc

EOI

EOO

# No-newline tests.
#
# @@ TMP Need does not compare test.
#
$* -i 1 <:"foo" >:"foo"                              # no-newline-str
#\
$* -i 1 <:"foo" >!"foo"                              # no-newline-str-fail1
$* -i 1 <"foo"  >:!"foo"                             # no-newline-str-fail2
#\

$* -i 1 <<:EOI >>:EOO                                # no-newline-doc
foo
EOI
foo
EOO

#\
$* -i 1 <<:EOI >>!EOO                                # no-newline-doc-fail1
foo
EOI
foo
EOO

$* -i 1 <<EOI >>:!EOO                                # no-newline-doc-fail2
foo
EOI
foo
EOO
#\

$* -i 1 <<:EOI >>:EOO 2>:""                          # no-newline-empty-str-doc
EOI
EOO

$* -i 1 <<:EOI >>:EOO                                # no-newline-nl-cont-doc

EOI

EOO

$* -o foo >>>out;                                    # file
$* -e bar 2>>>&out;
$* -i 1 <<<out >>EOO
foo
bar
EOO

$* -o foo -e bar 2>>EOE 1>&2                         # merge-str
foo
bar
EOE

$* -i 1 <<EOI -e baz >>EOO 2>&1                      # merge-doc
foo
bar
EOI
foo
bar
baz
EOO

$* -o foo -e bar 2>&1 >>>out;                        # merge-file
$* -e baz -o biz 1>&2 2>>>&out;
$* -i 1 <<<out >>EOO
foo
bar
baz
biz
EOO
