# file      : tests/test/script/runner/status.tests
# copyright : Copyright (c) 2014-2016 Code Synthesis Ltd
# license   : MIT; see accompanying LICENSE file

+mkdir build
+cat <<EOI >>>build/bootstrap.build
project = test
amalgamation =

using test
EOI

b = $effect($build.path) -q --no-column --buildfile - <"./: test{testscript}" \
  &?test/*** test
c = cat >>>testscript
test = "'$test'"

+if ($cxx.target.class == "windows")
  ext = ".exe"
end

# Successfull tests.
#
: eq-true
:
$c <"$* == 0";
$b

: ne-true
:
$c <"$* -s 1 != 0";
$b

# Faulty tests.
#
: eq-false
:
$c <"$* -s 1 == 0";
$b 2>>"EOE" != 0
testscript:1: error: ../../../driver$ext exit status 1 != 0
EOE

: ne-false
:
$c <"$* -s 1 != 1";
$b 2>>"EOE" != 0
testscript:1: error: ../../../driver$ext exit status 1 == 1
EOE
